[template name="Autopilot v0.0.1" id="autopilot"]
[wizard tab _label="About"]
	[wizard markdown]
		Quickly set up your basic inference settings, such as CFG and image dimensions.
	[/wizard]
[/wizard]
[wizard tab _label="Documentation"]
	[wizard markdown _file="MANUAL.md"][/wizard]
[/wizard]
[wizard tab _label="Changelog"]
	[wizard markdown _file="CHANGELOG.md"][/wizard]
[/wizard]

[wizard accordion _label="⚙️ Basic Settings" _open]
	[wizard row]
		[set inference_preset _new _info="Locks CFG scale, sampler, etc. to recommended values" _label="Inference Preset" _ui="dropdown" _choices="none|{filelist '%BASE_DIR%/templates/%PLACE%/presets/txt2img/*.*' _basename _hide_ext _places='user|common'}"]dpm_2m_fast_v1[/set]

		[set img2img_preset _new _info="Settings for img2img mode." _label="Img2img Preset" _ui="dropdown" _choices="none|{filelist '%BASE_DIR%/templates/%PLACE%/presets/img2img/*.*' _basename _hide_ext _places='user|common'}"]none[/set]
	[/wizard]

	[set aspect_ratio _new _label="📐 Aspect Ratio" _ui="dropdown" _choices="none|{filelist '%BASE_DIR%/templates/%PLACE%/presets/dimensions/*.*' _basename _hide_ext _places='user|common'}"]square_1-1[/set]
	[set detect_preset _new _label="Detect Preset" _info="Automatically pick a preset based on the aspect ratio number you provide. You can supply this from another template!"][get detect_preset _default=0][/set]
	[set flip_aspect_ratio _new _label="⇅ Flip Aspect Ratio" _ui="checkbox"]0[/set]

[/wizard]

[if "detect_preset > 0"]
	[if "detect_preset >= 0.4 and detect_preset <= 0.6"]
		[set aspect_ratio]square_1-1[/set]
	[/if]
	[elif "detect_preset >= 0.6 and detect_preset <= 0.8"]
		[set aspect_ratio]portrait_2-3[/set]
	[/elif]
	[elif "detect_preset >= 1.2 and detect_preset <= 2.0"]
		[set aspect_ratio]landscape_3-2[/set]
	[/elif]
[/if]

[if "aspect_ratio != 'none'"]
	[call "/presets/dimensions/{get aspect_ratio}" _places="user|common"]
[/if]
[if flip_aspect_ratio]
	[set width_temp][get width][/set]
	[set width][get height][/set]
	[set height][get width_temp][/set]
[/if]

[if "inference_preset != 'none'"]
	[call "/presets/txt2img/{get inference_preset}" _places="user|common"]
[/if]

[if "img2img_preset != 'none'"]
	[call "/presets/img2img/{get img2img_preset}" _places="user|common"]
[/if]